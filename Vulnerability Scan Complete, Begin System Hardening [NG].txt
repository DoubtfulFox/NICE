Vulnerability Scan Complete, Begin System Hardening [NG]

I opened Workstation-Desk and went to the E drive to view the Nessus file scan output. 

On 172.16.20.11 (Dev-Web), it had a critical vulnerability to Shellshock. I googled how to fix the vulnerability. I booted up Dev-Web instance and ran the command "sudo apt-get update && sudo apt-get install --only-upgrade bash". That seemed to fix the issue. 


On 172.16.20.21 (Mail), it had an outdated PHP version. I ran the "php -v" command and found it uses PHP 7.2.5. Then I ran the "cat /proc/version" command to see which disto of linux I'm using. It is SUSE. After finding out I'm using SUSE, I then entered the command "sudo zypper refresh && sudo zypper update". I then needed to update the PHP repositories. I did this by using command "sudo zypper addrepo https://download.opensuse.org/repositories/home:/Padom/15.3/home:Padom.repo" command. Then I refreshed the repository again, "sudo zypper refresh". Then finally installed a new version of PHP with "sudo zypper install php8". Then I did a reboot of the server, "sudo reboot". 

On 172.16.30.79 (Backup) it is vulnerable to the vsftpd Smiley Face Backdoor. I booted up the server and ran the command "sudo apt-get update && sudo apt-get install vsftpd". That seemed to fix the issue.

On 172.16.10.7 (Prod-Web) there is a Samba Badlock vulnerability. This was resolved by executing the command "sudo yum update samba" followed by "sudo reboot".


For the SSH issues first I started with 172.16.10.7 (Prod-Web). I corrected the issue "SSH Server CBC Mode Ciphers Enabled" by going into the /etc/ssh/sshd_config file and entering in "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" at the bottom of the file and saving it. Then I entered "systemctl reload sshd.service" then "systemctl status sshd.service" to verify sshd works.
For the "SSH Weak Key Exchanged Algorithms Enabled" I worked Prod-Web again. I went into the /etc/ssh/sshd_config file and added "KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256" and saved the file. Again I reloaded sshd.service and did another status check to verify nothing stopped working. 

Finally addressed the "SSH Weak MAC Algorithms Enabled" issue. I started with Prod-Web. Going into the /etc/ssh/ssd_config file I entered "MACs hmac-sha1,umac-64@openssh.com,hmac-ripemd160" and "Ciphers aes128-ctr,aes192-ctr,aes256-ctr" then saved the file. Then once again I reloaded sshd and did a status check. I did the same process on the four other instances; 172.16.20.11, 172.16.30.21, 172.16.30.32, & 172.16.30.79
.